import{_ as l}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,b as s,d as i,a,o as t}from"./app-BHATrGVZ.js";const h="data:image/png;base64,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",e="data:image/png;base64,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",k="/assets/demo-DCYi5i1s.png",p={},r=a(`<h1 id="使用-matplotlib-渲染-latex-公式" tabindex="-1"><a class="header-anchor" href="#使用-matplotlib-渲染-latex-公式"><span>使用 Matplotlib 渲染 Latex 公式</span></a></h1><p>需求：将 Latex 公式转为图片，svg 或 png 格式。</p><p>其实我们熟悉的 matplotlib 就支持这个功能，可以应付一些简单的情况（复杂的后面说）。</p><h2 id="基本用法" tabindex="-1"><a class="header-anchor" href="#基本用法"><span>基本用法</span></a></h2><div class="language-py line-numbers-mode" data-highlighter="shiki" data-ext="py" data-title="py" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> matplotlib.font_manager </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> mfm</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> matplotlib.mathtext </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> math_to_image</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">prop </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> mfm.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">FontProperties</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">math_fontfamily</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;stix&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">64</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">weight</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;bold&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">math_to_image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">r</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">&quot;$\\sum_{i=1}^n i$&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;path/to/output.svg&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">prop</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">prop, </span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">dpi</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">72</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>两行代码结束。下面解释一些内容。</p><ul><li><code>math_fontfamily</code>：数学字体。有多个选项（见 api），这个字体是我认为比较合适的、接近一般印刷体的。</li><li><code>size</code>：字体大小。</li><li><code>weight</code>：粗细。其实对数学字体不起作用。</li><li><code>dpi</code>：输出图像的 DPI。</li><li>公式可以不全是 latex 公式，只有 <code>$$</code> 内的才会解释为 latex。</li><li>输出可以是路径或 buffer。如果路径自带后缀名，可以不用指定 format。</li></ul><h2 id="图片边界问题" tabindex="-1"><a class="header-anchor" href="#图片边界问题"><span>图片边界问题</span></a></h2>`,8),d={class:"katex"},A=s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mfrac",null,[s("mrow",null,[s("mi",{mathvariant:"normal"},"∂"),s("mi",null,"ρ")]),s("mrow",null,[s("mi",{mathvariant:"normal"},"∂"),s("mi",null,"t")])]),s("mo",null,"="),s("mo",null,"−"),s("mi",{mathvariant:"normal"},"∇"),s("mo",null,"⋅"),s("mover",{accent:"true"},[s("mi",null,"j"),s("mo",null,"⃗")])]),s("annotation",{encoding:"application/x-tex"},"\\frac{\\partial\\rho}{\\partial t}=-\\nabla\\cdot\\vec{j}")])])],-1),g={class:"katex-html","aria-hidden":"true"},B=a('<span class="base"><span class="strut" style="height:1.2772em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">ρ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">∇</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span>',2),y={class:"base"},o=s("span",{class:"strut",style:{height:"1.137em","vertical-align":"-0.1944em"}},null,-1),c={class:"mord accent"},m={class:"vlist-t vlist-t2"},F={class:"vlist-r"},u={class:"vlist",style:{height:"0.9425em"}},C=s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.05724em"}},"j")],-1),v={style:{top:"-3.2285em"}},b=s("span",{class:"pstrut",style:{height:"3em"}},null,-1),f={class:"accent-body",style:{left:"-0.2355em"}},D={class:"overlay",style:{height:"0.714em",width:"0.471em"}},E={xmlns:"http://www.w3.org/2000/svg",width:"0.471em",height:"0.714em",style:{width:"0.471em"},viewBox:"0 0 471 714",preserveAspectRatio:"xMinYMin"},x=s("path",{d:`M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z`},null,-1),w=[x],M=s("span",{class:"vlist-s"},"​",-1),q=s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.1944em"}},[s("span")])],-1),Y=a('<figure><img src="'+h+`" alt="" tabindex="0" loading="lazy"><figcaption><code>$\\frac{\\partial\\rho}{\\partial t}=-\\nabla\\cdot\\vec{j}$</code></figcaption></figure><p>边界计算出了点问题，导致图片外围有部分被截断了。</p><p>如何解决这个问题呢？注意到，<code>math_to_image</code> 没有任何参数来控制 margin。但是我们可以重写一个！来看看它原来是怎样的：</p><div class="language-py line-numbers-mode" data-highlighter="shiki" data-ext="py" data-title="py" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> math_to_image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> filename_or_obj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> prop</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">None</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> dpi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">None</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> format</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">None</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                  *</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">color</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">None</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    Given a math expression, renders it in a closely-clipped bounding</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    box to an image file.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    Parameters</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    ----------</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    s : str</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        A math expression.  The math portion must be enclosed in dollar signs.</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    filename_or_obj : str or path-like or file-like</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        Where to write the image data.</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    prop : \`.FontProperties\`, optional</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        The size and style of the text.</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    dpi : float, optional</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        The output dpi.  If not set, the dpi is determined as for</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        \`.Figure.savefig\`.</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    format : str, optional</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        The output format, e.g., &#39;svg&#39;, &#39;pdf&#39;, &#39;ps&#39; or &#39;png&#39;.  If not set, the</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        format is determined as for \`.Figure.savefig\`.</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    color : str, optional</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        Foreground color, defaults to :rc:\`text.color\`.</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> matplotlib </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> figure</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    parser </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> MathTextParser</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;path&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    width, height, depth, _, _ </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> parser.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">parse</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(s, </span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">dpi</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">72</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">prop</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">prop)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    fig </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> figure.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Figure</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">figsize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(width </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 72.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, height </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 72.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    fig.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">text</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, depth</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">height, s, </span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">fontproperties</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">prop, </span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">color</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">color)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    fig.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">savefig</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(filename_or_obj, </span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">dpi</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">dpi, </span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">format</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">format</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> depth</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>它做的就是利用 parser 计算出公式的尺寸，然后画到 figure 上，再把 figure 保存。那么这里就有操作空间了，增加一下<code>figsize</code>。将这个函数复制一份，修改如下：</p><div class="language-py line-numbers-mode" data-highlighter="shiki" data-ext="py" data-title="py" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	fig </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> figure.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Figure</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">figsize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">((width</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">40</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 72.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, height </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 72.0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    fig.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">text</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> /</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> width, depth</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">height, s, </span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">fontproperties</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">prop, </span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">color</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">color)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>这样成功实现了增加 margin。</p><figure><img src="`+e+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>',8),z=s("p",null,[i("这里 margin 可以自适应调整一下。需要注意，"),s("code",null,"fig.text"),i(" 的坐标范围是归一化的 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mo",{stretchy:"false"},"["),s("mn",null,"0"),s("mo",{separator:"true"},","),s("mn",null,"1"),s("mo",{stretchy:"false"},"]")]),s("annotation",{encoding:"application/x-tex"},"[0,1]")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"["),s("span",{class:"mord"},"0"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord"},"1"),s("span",{class:"mclose"},"]")])])]),i("。")],-1),O=a(`<h2 id="对输出图片做处理" tabindex="-1"><a class="header-anchor" href="#对输出图片做处理"><span>对输出图片做处理</span></a></h2><p>下面实现了一个功能：将图片反色（默认是黑色字白色背景），并且去除背景色。<br> 因为本来就是黑白的，所以只需要提取 rgb 之一的通道，将其取反后作为新的各通道值。</p><div class="language-py line-numbers-mode" data-highlighter="shiki" data-ext="py" data-title="py" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> io </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> BytesIO</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;"> PIL</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Image</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> numpy </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> np</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> get_img</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">tex</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    bfo </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> BytesIO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">    math_to_image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(tex, bfo, </span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">prop</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">prop, </span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">dpi</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">72</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    im </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Image.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">open</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(bfo)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    r, g, b, a </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> im.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">split</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Image.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">fromarray</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">255</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> np.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">array</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(r))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    im </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Image.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">merge</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;RGBA&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, (x, x, x, x))</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> im</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="公式语法支持" tabindex="-1"><a class="header-anchor" href="#公式语法支持"><span>公式语法支持</span></a></h2><p>Matplotlib 的 latex 语法是比较弱的，它只支持一个较小但常用的子集。暂时没看到完整版的支持列表。</p><p>目前已知不支持的有：</p><ul><li><code>\\LaTeX</code></li><li><code>\\color</code></li><li><code>\\mathrm</code></li><li><code>\\begin</code></li><li><code>\\varPhi</code></li><li><code>\\frac{}{}</code> 缺括号</li></ul><h2 id="与公式识别结合" tabindex="-1"><a class="header-anchor" href="#与公式识别结合"><span>与公式识别结合</span></a></h2><p>这里我们尝试识别图片公式再渲染。一个免费的识别网站为 <code>https://simpletex.cn/ai/latex_ocr</code></p><p>它的效果比 Mathpix 稍差，比如可能错误识别字体，<code>\\varphi</code> 识别成 <code>\\phi</code>，<code>\\hat</code> 识别成 <code>\\widehat</code>。</p><p>下面做一个简单的处理：</p><div class="language-py line-numbers-mode" data-highlighter="shiki" data-ext="py" data-title="py" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> sub_d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">m</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> re.Match[</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">str</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (m.string[m.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">start</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:m.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">start</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()] </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> r</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\m</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">athrm{&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            or</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> m.string[m.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">start</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> m[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> r</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\!\\m</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">athrm{d}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> fix_tex</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    s </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> re.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">sub</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">r</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">frac</span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66;">)</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">\\s</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">a-zA-Z</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">]+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">\\w</span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66;">)</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">r</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">\\1</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">{</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">\\2</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">}&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, s) </span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 简单地加括号</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    s </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> re.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">sub</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">r</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">color</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\{</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">+?</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\}</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, s) </span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 去掉 \\color</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    s </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> s.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">replace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">r</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\t</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">ext&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 去掉 \\text</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    s </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> s.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">replace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;e^&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">r</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\m</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">athrm{e}^&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 把 e 转为正体</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    s </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> re.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">sub</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">r</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(?&lt;!</span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">a-z</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">]</span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">d&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, sub_d, s)  </span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 微分符号</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    s </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> s.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">replace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">r</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">&quot;\\widehat&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">r</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\h</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">at&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> s</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>涉及到 <code>\\frac</code> 括号匹配的稍微复杂点，需要做词法分析。如果工作量不大还是手动修复吧。</p><h2 id="把公式绘制画布上" tabindex="-1"><a class="header-anchor" href="#把公式绘制画布上"><span>把公式绘制画布上</span></a></h2>`,14),T=s("p",null,[i("下面是一个示例。将公式 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mo",{stretchy:"false"},"("),s("mi",null,"ψ"),s("mo",{separator:"true"},","),s("mi",null,"φ"),s("msup",null,[s("mo",{stretchy:"false"},")"),s("mo",null,"∗")]),s("mo",null,"="),s("mo",{stretchy:"false"},"("),s("mi",null,"φ"),s("mo",{separator:"true"},","),s("mi",null,"ψ"),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"(\\psi,\\varphi)^*=(\\varphi,\\psi)")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"ψ"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord mathnormal"},"φ"),s("span",{class:"mclose"},[s("span",{class:"mclose"},")"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.6887em"}},[s("span",{style:{top:"-3.063em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mbin mtight"},"∗")])])])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord mathnormal"},"φ"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"ψ"),s("span",{class:"mclose"},")")])])]),i(" 画到 Figure 上，两个均位于中心，一个旋转了 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mn",null,"30"),s("mi",{mathvariant:"normal"},"°")]),s("annotation",{encoding:"application/x-tex"},"30\\degree")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord"},"30°")])])]),i("，一个改变了字体大小。利用 Image 在 jupyter 显示。")],-1),Z=a(`<div class="language-py line-numbers-mode" data-highlighter="shiki" data-ext="py" data-title="py" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> matplotlib </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> figure</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> matplotlib.text </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Text</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    s </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> r</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">&quot;$</span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\p</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">si,</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\v</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">arphi</span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66;">)</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">^</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\v</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">arphi,</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\p</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">si</span><span style="--shiki-light:#0184BC;--shiki-dark:#D19A66;">)</span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">$&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    fig </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> figure.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Figure</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">figsize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1920</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> /</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 72.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1080</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> /</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 72.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    args </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;fontproperties&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: prop,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;horizontalalignment&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;center&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;verticalalignment&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;center&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;animated&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">True</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    fig.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">text</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, s, </span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">rotation</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, **args)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    fig.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">text</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, s, </span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">fontsize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ,**args)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    bfo </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> BytesIO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    fig.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">savefig</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(bfo)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    im </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Image.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">open</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(bfo)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> im</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">test</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+k+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>',2);function P(R,V){return t(),n("div",null,[r,s("p",null,[i("直接这样做会有一个问题。比如 "),s("span",d,[A,s("span",g,[B,s("span",y,[o,s("span",c,[s("span",m,[s("span",F,[s("span",u,[C,s("span",v,[b,s("span",f,[s("span",D,[(t(),n("svg",E,w))])])])]),M]),q])])])])]),i("，它渲染出来是这样的：")]),Y,z,O,T,Z])}const J=l(p,[["render",P],["__file","matplotlib-latex-render.html.vue"]]),L=JSON.parse(`{"path":"/posts/python/matplotlib-latex-render.html","title":"使用 Matplotlib 渲染 Latex 公式","lang":"en-US","frontmatter":{"category":["python","matplotlib"],"tag":["latex","troubleshooting"],"isOriginal":true,"date":"2023-07-30T00:00:00.000Z","description":"使用 Matplotlib 渲染 Latex 公式 需求：将 Latex 公式转为图片，svg 或 png 格式。 其实我们熟悉的 matplotlib 就支持这个功能，可以应付一些简单的情况（复杂的后面说）。 基本用法 两行代码结束。下面解释一些内容。 math_fontfamily：数学字体。有多个选项（见 api），这个字体是我认为比较合适的、接...","head":[["meta",{"property":"og:url","content":"https://QuadnucYard.github.io/posts/python/matplotlib-latex-render.html"}],["meta",{"property":"og:title","content":"使用 Matplotlib 渲染 Latex 公式"}],["meta",{"property":"og:description","content":"使用 Matplotlib 渲染 Latex 公式 需求：将 Latex 公式转为图片，svg 或 png 格式。 其实我们熟悉的 matplotlib 就支持这个功能，可以应付一些简单的情况（复杂的后面说）。 基本用法 两行代码结束。下面解释一些内容。 math_fontfamily：数学字体。有多个选项（见 api），这个字体是我认为比较合适的、接..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2023-07-30T09:41:43.000Z"}],["meta",{"property":"article:author","content":"Stankle of QuadnucYard"}],["meta",{"property":"article:tag","content":"latex"}],["meta",{"property":"article:tag","content":"troubleshooting"}],["meta",{"property":"article:published_time","content":"2023-07-30T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-07-30T09:41:43.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"使用 Matplotlib 渲染 Latex 公式\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-07-30T00:00:00.000Z\\",\\"dateModified\\":\\"2023-07-30T09:41:43.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Stankle of QuadnucYard\\",\\"url\\":\\"https://github.com/QuadnucYard\\"}]}"]]},"headers":[{"level":2,"title":"基本用法","slug":"基本用法","link":"#基本用法","children":[]},{"level":2,"title":"图片边界问题","slug":"图片边界问题","link":"#图片边界问题","children":[]},{"level":2,"title":"对输出图片做处理","slug":"对输出图片做处理","link":"#对输出图片做处理","children":[]},{"level":2,"title":"公式语法支持","slug":"公式语法支持","link":"#公式语法支持","children":[]},{"level":2,"title":"与公式识别结合","slug":"与公式识别结合","link":"#与公式识别结合","children":[]},{"level":2,"title":"把公式绘制画布上","slug":"把公式绘制画布上","link":"#把公式绘制画布上","children":[]}],"git":{"createdTime":1690710103000,"updatedTime":1690710103000,"contributors":[{"name":"QuadnucYard","email":"2380433991@qq.com","commits":1}]},"readingTime":{"minutes":3.73,"words":1119},"filePathRelative":"posts/python/matplotlib-latex-render.md","localizedDate":"July 30, 2023","excerpt":"\\n<p>需求：将 Latex 公式转为图片，svg 或 png 格式。</p>\\n<p>其实我们熟悉的 matplotlib 就支持这个功能，可以应付一些简单的情况（复杂的后面说）。</p>\\n<h2>基本用法</h2>\\n<div class=\\"language-py line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"py\\" data-title=\\"py\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">import</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> matplotlib.font_manager </span><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">as</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> mfm</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">from</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> matplotlib.mathtext </span><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">import</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> math_to_image</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">prop </span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> mfm.</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#61AFEF\\">FontProperties</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">(</span><span style=\\"--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">math_fontfamily</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">'stix'</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">, </span><span style=\\"--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">size</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\">64</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">, </span><span style=\\"--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">weight</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">'bold'</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">)</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#61AFEF\\">math_to_image</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">(</span><span style=\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\">r</span><span style=\\"--shiki-light:#0184BC;--shiki-dark:#E06C75\\">\\"$\\\\sum_{i=1}^n i$\\"</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">, </span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"path/to/output.svg\\"</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">, </span><span style=\\"--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">prop</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">prop, </span><span style=\\"--shiki-light:#986801;--shiki-dark:#E06C75;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic\\">dpi</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\">72</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">)</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}`);export{J as comp,L as data};
