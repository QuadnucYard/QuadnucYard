import{_ as o}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as p,o as c,c as i,b as s,d as n,e,f as t}from"./app-iu28kjPy.js";const l={},r=t('<h1 id="ae-脚本入门-3-批量更改素材路径" tabindex="-1"><a class="header-anchor" href="#ae-脚本入门-3-批量更改素材路径" aria-hidden="true">#</a> AE 脚本入门 3：批量更改素材路径</h1><div class="hint-container info"><p class="hint-container-title">需求</p><p>一个很常见的需求：我的项目素材库里放了大量素材，在文件系统中更改了它们的位置，导致在 AE 中缺失。如何重新链接素材文件？</p></div><h2 id="前置知识-file" tabindex="-1"><a class="header-anchor" href="#前置知识-file" aria-hidden="true">#</a> 前置知识：File</h2>',3),u={href:"https://ae-scripting.docsforadobe.dev/items/footageitem.html",target:"_blank",rel:"noopener noreferrer"},d=s("code",null,"FootageItem",-1),k=s("code",null,"file",-1),h=s("code",null,"replace",-1),_=s("code",null,"File",-1),f=s("code",null,"File",-1),v=s("code",null,"File",-1),m={href:"https://extendscript.docsforadobe.dev/file-system-access/file-object.html",target:"_blank",rel:"noopener noreferrer"},b=s("code",null,"new File ([ path ] );",-1),g=s("code",null,"path",-1),x={href:"https://extendscript.docsforadobe.dev/file-system-access/using-file-and-folder-objects.html#specifying-paths",target:"_blank",rel:"noopener noreferrer"},F=s("code",null,"Driver:\\path\\to\\file",-1),j=s("code",null,"File",-1),y=s("code",null,"fsName",-1),w=t(`<h2 id="实操" tabindex="-1"><a class="header-anchor" href="#实操" aria-hidden="true">#</a> 实操</h2><p>下面开始动手了。首先要知道需要修复哪些素材的路径，最简单的方法应该是在素材库里选中，这样就可获取了。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> selection <span class="token operator">=</span> app<span class="token punctuation">.</span>project<span class="token punctuation">.</span>selection<span class="token punctuation">;</span> <span class="token comment">// Array of FootageItem, indexed [0..n-1]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后循环，对于每项，获取它的 <code>file</code> 的路径，替换成想要的，再构造一个新的 <code>File</code> 给 <code>replace</code> 掉即可。</p><p>完整代码如下：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>app<span class="token punctuation">.</span><span class="token function">beginUndoGroup</span><span class="token punctuation">(</span><span class="token string">&quot;Fix footage paths&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> selection <span class="token operator">=</span> app<span class="token punctuation">.</span>project<span class="token punctuation">.</span>selection<span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> selection<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> it <span class="token operator">=</span> selection<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
  it<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span>file<span class="token punctuation">.</span>fsName<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;\\\\assets\\\\&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\\\\assets\\\\images\\\\&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
app<span class="token punctuation">.</span><span class="token function">endUndoGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6);function q(N,E){const a=p("ExternalLinkIcon");return c(),i("div",null,[r,s("p",null,[n("看过"),s("a",u,[n("文档"),e(a)]),n("应该知道，素材是 "),d,n(" 对象。它有一个属性为 "),k,n("，表示对应的源文件。这是只读的，无法修改。但是有 "),h,n(" 方法，它接受一个 "),_,n(" 类型的参数，表示替换素材。该方法执行后，会更新素材的名称、长宽等属性。")]),s("p",null,[n("如何创建这个 "),f,n(" 呢？根据 "),v,n(" 的"),s("a",m,[n("文档"),e(a)]),n("，可以用 "),b,n(" 来构造，这里 "),g,n(" 形式比较多样，可以是当前平台文件系统路径，也可以是 URI 格式。由"),s("a",x,[n("详细说明"),e(a)]),n("可知，平台特定路径就是我们熟悉的 "),F,n("，并且可以通过 "),j,n(" 对象的 "),y,n(" 属性获取。")]),w])}const A=o(l,[["render",q],["__file","ae-scripts-files.html.vue"]]);export{A as default};
