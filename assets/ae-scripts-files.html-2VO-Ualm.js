import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as s,o as e,a}from"./app-BsCwuexf.js";const t={},n=a(`<h1 id="ae-脚本入门-3-批量更改素材路径" tabindex="-1"><a class="header-anchor" href="#ae-脚本入门-3-批量更改素材路径"><span>AE 脚本入门 3：批量更改素材路径</span></a></h1><div class="hint-container info"><p class="hint-container-title">需求</p><p>一个很常见的需求：我的项目素材库里放了大量素材，在文件系统中更改了它们的位置，导致在 AE 中缺失。如何重新链接素材文件？</p></div><h2 id="前置知识-file" tabindex="-1"><a class="header-anchor" href="#前置知识-file"><span>前置知识：File</span></a></h2><p>看过<a href="https://ae-scripting.docsforadobe.dev/items/footageitem.html" target="_blank" rel="noopener noreferrer">文档</a>应该知道，素材是 <code>FootageItem</code> 对象。它有一个属性为 <code>file</code>，表示对应的源文件。这是只读的，无法修改。但是有 <code>replace</code> 方法，它接受一个 <code>File</code> 类型的参数，表示替换素材。该方法执行后，会更新素材的名称、长宽等属性。</p><p>如何创建这个 <code>File</code> 呢？根据 <code>File</code> 的<a href="https://extendscript.docsforadobe.dev/file-system-access/file-object.html" target="_blank" rel="noopener noreferrer">文档</a>，可以用 <code>new File ([ path ] );</code> 来构造，这里 <code>path</code> 形式比较多样，可以是当前平台文件系统路径，也可以是 URI 格式。由<a href="https://extendscript.docsforadobe.dev/file-system-access/using-file-and-folder-objects.html#specifying-paths" target="_blank" rel="noopener noreferrer">详细说明</a>可知，平台特定路径就是我们熟悉的 <code>Driver:\\path\\to\\file</code>，并且可以通过 <code>File</code> 对象的 <code>fsName</code> 属性获取。</p><h2 id="实操" tabindex="-1"><a class="header-anchor" href="#实操"><span>实操</span></a></h2><p>下面开始动手了。首先要知道需要修复哪些素材的路径，最简单的方法应该是在素材库里选中，这样就可获取了。</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">var</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> selection</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">project</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">selection</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">// Array of FootageItem, indexed [0..n-1]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>然后循环，对于每项，获取它的 <code>file</code> 的路径，替换成想要的，再构造一个新的 <code>File</code> 给 <code>replace</code> 掉即可。</p><p>完整代码如下：</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" data-title="js" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">beginUndoGroup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Fix footage paths&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">var</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> selection</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">project</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">selection</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">var</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> &lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> selection</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  var</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> it</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> selection</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  it</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">replace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> File</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">it</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">fsName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">replace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">assets</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">assets</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">images</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)));</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">app</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">endUndoGroup</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,11),l=[n];function h(p,k){return e(),s("div",null,l)}const o=i(t,[["render",h],["__file","ae-scripts-files.html.vue"]]),c=JSON.parse('{"path":"/posts/adobe/ae-scripts-files.html","title":"AE 脚本入门 3：批量更改素材路径","lang":"en-US","frontmatter":{"category":["AE"],"tag":["ExtendScript","tutorial"],"isOriginal":true,"date":"2023-08-22T00:00:00.000Z","description":"AE 脚本入门 3：批量更改素材路径 需求 一个很常见的需求：我的项目素材库里放了大量素材，在文件系统中更改了它们的位置，导致在 AE 中缺失。如何重新链接素材文件？ 前置知识：File 看过文档应该知道，素材是 FootageItem 对象。它有一个属性为 file，表示对应的源文件。这是只读的，无法修改。但是有 replace 方法，它接受一个 F...","head":[["meta",{"property":"og:url","content":"https://QuadnucYard.github.io/posts/adobe/ae-scripts-files.html"}],["meta",{"property":"og:title","content":"AE 脚本入门 3：批量更改素材路径"}],["meta",{"property":"og:description","content":"AE 脚本入门 3：批量更改素材路径 需求 一个很常见的需求：我的项目素材库里放了大量素材，在文件系统中更改了它们的位置，导致在 AE 中缺失。如何重新链接素材文件？ 前置知识：File 看过文档应该知道，素材是 FootageItem 对象。它有一个属性为 file，表示对应的源文件。这是只读的，无法修改。但是有 replace 方法，它接受一个 F..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2023-08-22T12:08:00.000Z"}],["meta",{"property":"article:author","content":"Stankle of QuadnucYard"}],["meta",{"property":"article:tag","content":"ExtendScript"}],["meta",{"property":"article:tag","content":"tutorial"}],["meta",{"property":"article:published_time","content":"2023-08-22T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-08-22T12:08:00.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"AE 脚本入门 3：批量更改素材路径\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-08-22T00:00:00.000Z\\",\\"dateModified\\":\\"2023-08-22T12:08:00.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Stankle of QuadnucYard\\",\\"url\\":\\"https://github.com/QuadnucYard\\"}]}"]]},"headers":[{"level":2,"title":"前置知识：File","slug":"前置知识-file","link":"#前置知识-file","children":[]},{"level":2,"title":"实操","slug":"实操","link":"#实操","children":[]}],"git":{"createdTime":1692706080000,"updatedTime":1692706080000,"contributors":[{"name":"QuadnucYard","email":"2380433991@qq.com","commits":1}]},"readingTime":{"minutes":1.34,"words":403},"filePathRelative":"posts/adobe/ae-scripts-files.md","localizedDate":"August 22, 2023","excerpt":"\\n<div class=\\"hint-container info\\">\\n<p class=\\"hint-container-title\\">需求</p>\\n<p>一个很常见的需求：我的项目素材库里放了大量素材，在文件系统中更改了它们的位置，导致在 AE 中缺失。如何重新链接素材文件？</p>\\n</div>\\n<h2>前置知识：File</h2>\\n<p>看过<a href=\\"https://ae-scripting.docsforadobe.dev/items/footageitem.html\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">文档</a>应该知道，素材是 <code>FootageItem</code> 对象。它有一个属性为 <code>file</code>，表示对应的源文件。这是只读的，无法修改。但是有 <code>replace</code> 方法，它接受一个 <code>File</code> 类型的参数，表示替换素材。该方法执行后，会更新素材的名称、长宽等属性。</p>","autoDesc":true}');export{o as comp,c as data};
